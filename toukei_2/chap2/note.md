# 確率と確率分布

目標: 確率, 確率変数, 確率分布の理解

- 確率・確率変数・確率分布の基本的な理解
- 離散型確率分布と連続型確率分布
- 2変数確率分布
- 主な標本分布と大標本の基本定理

## 2.3 ベイズの定理

ある事象 $A$ に対して, その事象の原因として背反な $n$ 個の事象 $H_1, H_2,\ldots ,H_n$ が考えられ, それ以外に原因は無いとする.

$$
P(H_i | A) = \frac{P(H_i \land A)}{P(A)}
$$

右辺の分子の積事象の確率を乗法定理によって分解する.

$$
P(H_i | A) = \frac{P(H_i)P(A|H_i)}{P(A)}
$$

右辺の分母 $P(A)$ は複数の原因によって起こる事象 $A$ の総合的な生起確率を表す. この値を知ることはできないが, 各原因の出現確率 $P(H_i)$ と原因ごとに事象 $A$ の起こる条件付き確率 $P(A|H_i)$ が過去のデータから推定できるとき, $P(A)=P(A\land \Omega)$ であり, $\Omega = H_1 \lor H_2, \ldots , \lor H_n$かつ$H_i\land H_j = \emptyset, i \neq j$ を利用して, 以下のように変形できる.

$$
P(A) = P(A\land H_1) + P(A\land H_2) + \ldots + P(A\land H_n) \\
= P(H_1)P(A|H_1) + P(H_2)P(A|H_2) + \ldots + P(H_n)P(A|H_n) \\
= \sum_{j=1}^n P(H_j)P(A|H_j)
$$

ここからベイズの定理(Bayes' theorem)が得られる.

$$
P(H_i | A) = \frac{P(H_i)P(A|H_i)}{\sum_{j=1}^n P(H_j)P(A|H_j)}
$$

$P(H_i)$ は事前確率(prior probability), $P(H_i | A)$ は事後確率(posterior probability), $P(A|H_i)$ は尤度(likelihood), $\sum_{j=1}^n P(H_j)P(A|H_j)$ は事象 $A$ が発生する全体の確率, すなわち周辺尤度(marginal likelihood)と呼ばれる.

## 2.4 確率変数と確率分布

確率変数(random variable) $X$ は, 標本空間の各要素に実数を割り当てる関数として定義される. すなわち, $X$ は標本空間 $\Omega$ から実数の集合 $\mathbb{R}$ への写像である. このとき, $X$ が取りうる値の集合を $X$ の値域(range)と呼び, $X$ の値域が有限個の場合は離散型確率変数(discrete random variable), 無限個の場合は連続型確率変数(continuous random variable)と呼ばれる.

離散型確率変数の取りうる値を $\{x_1,x_2,\ldots\}$ とし, それに対して確率 $\{P(X=x_i)=f(x_i)\}$ が与えられるとする. このとき, $f(x_i)$ を確率関数(probability function)とよばれ, 確率の公理より以下の性質を満たす.

$$
0 \leq f(x_i) \leq 1 \\
\sum_{i=1}^\infty f(x_i) = 1
$$

$X$ の取りうる値が有限個である場合も同様に考えることができる.

連続確率変数の場合, 任意の個別の点での確率は0であり, 代わりに確率は値の範囲に関して定義される. 任意の$x$および微小な$\Delta x$に対して, $X$ が 区間 $[x, x + \Delta x]$ に含まれる確率は
$$

P(x \leq X \leq x + \Delta x) \simeq f(x) \Delta x

$$

$X$ が区間 $[a,b]$ に含まれる確率が

$$
P(a \leq X \leq b) = \int_a^b f(x) dx
$$

の形の積分で表されるような関数 $f(x)\geq 0$ を考える. この関数は $X$ の確率密度関数(probability density function)と呼ばれ, 確率の公理より以下の性質を満たす.
$$
\int_{-\infty}^\infty f(x) dx = 1
$$

離散型, 連続型のどちらの確率変数に対しても, 累積分布関数(cumulative distribution function)あるいは分布関数(distribution function)と呼ばれる関数が $F(x) = P(X \leq x)$ として定義される. 連続型については,

$$
F(x) = \int_{-\infty}^x f(u) du
$$

で表され, 累積分布関数が連続かつ微分可能であるとき, その導関数は確率密度関数に等しい.

## 2.5 期待値と分散

確率変数 $X$ の期待値(expectation)は, $X$ の取りうる値 $x_i$ に対して, その確率 $f(x_i)$ を重みとして加重平均した値として定義される.

離散型の期待値は以下のように定義される.

$$
E[X] = \sum_{i} x_i f(x_i) = \mu \tag{2.5.1}
$$

連続型の場合は以下のように定義される.

$$
E[X] = \int_{-\infty}^\infty x f(x) dx = \mu \tag{2.5.2}
$$

定義式からも分かる通り, 期待値は分布の重心を表す. $\mu$ は平均を示す.

期待値と観測データの平均について述べる. 確率変数 $X$ がある離散型確率分布に従う時, 確率変数 $X$ の実現値として得られるデータが度数分布表の形で整理されている場合を考える. $X=X_i$ という観測値を取る相対度数を $N_i/N$ , 確率を$p_i$ と表すと, データの平均は $\bar{x}=\sum_i x_i N_i/N$, 期待値は $\mu = \sum_i x_i p_i$ と計算される. 大数の法則より, 相対度数 $N_i / N$ は $N$ が大きくなるとき確率 $p_i$ に近づく. その意味で, 期待値は観測データの平均に対応する概念であり, 理論的な確率分布の平均(あるいは母集団分布の平均: 母平均)を表すものと理解できる. なお, 連続型確率分布の場合も同様に考えることができる.

$X$ が確率変数であるとき, その関数 $u(x)$ も確率変数であるから, その期待値を考えることができる. $X$ の確率関数あるいは確率密度関数は, 離散型と連続型でそれぞれ以下のように定義できる.

$$
E[u(X)] \equiv \sum_i u(x_i) f(x_i) \tag{2.5.1'}
$$

$$
E[u(X)] \equiv \int_{-\infty}^\infty u(x) f(x) dx \tag{2.5.2'}
$$

確率の散らばりの指標である分散(variance)は, 母平均 $\mu$ からの偏差の二乗の期待値として定義される.

$$
V[X] \equiv E[(X-\mu)^2] = \sum_i (x_i - \mu)^2 f(x_i) = \sigma^2 \tag{2.5.3}
$$

$$
V[X] \equiv E[(X-\mu)^2] = \int_{-\infty}^\infty (x - \mu)^2 f(x) dx = \sigma^2 \tag{2.5.4}
$$

分散の平方根を標準偏差(standard deviation)と呼び, $\sigma$ で表す. 確率分布の期待値(母平均)が観測データに基づく平均(標本平均)に対応するように, 分散は観測データに基づく分散(標本分散)に対応するものと考えることができる. なお, $V[X]$ は以下のようにもっ書ける.

$$
V[X] = E[X^2] - E[X]^2 = E[X^2] - \mu^2 \tag{2.5.5}
$$

$E[X]$ の線形性は以下のように確認できる.

$$
\begin{align*}
E[aX + b] &= \sum_i (ax_i + b) f(x_i) \\
          &= a \sum_i x_i f(x_i) + b \sum_i f(x_i) \\
          &= a E[X] + b
\end{align*} \tag{2.5.6}
$$

上記の変形から, $E(X)$ は線形性が成り立つことがわかるので以下のような変換ができる.

$$
\begin{align*}
V[X] &= E[(X-\mu)^2] \\
     &= E[X^2 - 2\mu X + \mu^2] \\
     &= E[X^2] - 2\mu E[X] + \mu^2 \\
     &= E[X^2] - 2\mu^2 + \mu^2 \\
     &= E[X^2] - \mu^2
\end{align*} \tag{2.5.5}
$$

なお, 分散の場合は線形性は示さないことが, 上の式変形を用いて示すことができる.

$$
\begin{align*}
V[aX + b] &= E[(aX + b)^2] - E[aX + b]^2 \\
          &= E[a^2X^2 + 2abX + b^2] - (aE[X] + b)^2 \\
          &= (a^2E[X^2] + 2abE[X] + b^2) - (a^2E[X]^2 + 2abE[X] + b^2) \\
          &= a^2E[X^2] - a^2E[X]^2 \\
          &= a^2(E[X^2] - E[X]^2) \\
          &= a^2V[X]
\end{align*} \tag{2.5.7}
$$

また, $V[X]$ は以下のようにも表せる.

$$
V[X] = E[(X-E[X])^2]
$$
